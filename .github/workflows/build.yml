name: Build Snap

on:
  push:
    branches:
      - master
  pull_request:
    branches:
      - master
  workflow_dispatch:

jobs:
  build-snap:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout cups-snap sources
        uses: actions/checkout@v6

      - name: Show Ubuntu version
        run: cat /etc/os-release | grep PRETTY_NAME | awk -F '=' '{print $2}'

      # Build verification only â€“ no publish/upload to Snap Store
      - name: Build snap with snapcraft
        id: snapcraft
        uses: snapcore/action-build@v1
        with:
          path: .

      - name: Upload snap artifact
        uses: actions/upload-artifact@v6
        if: ${{ !cancelled() }}
        with:
          name: cups-snap-build
          path: ${{ steps.snapcraft.outputs.snap }}